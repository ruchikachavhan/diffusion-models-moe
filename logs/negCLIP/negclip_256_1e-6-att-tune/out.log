2024-02-27,18:03:08 | INFO | Running with a single process. Device cuda:0.
2024-02-27,18:03:08 | INFO | Loading pretrained ViT-B-32 from OpenAI.
2024-02-27,18:03:19 | INFO | Model:
2024-02-27,18:03:19 | INFO | CLIP(
  (visual): VisualTransformer(
    (conv1): Conv2d(3, 768, kernel_size=(32, 32), stride=(32, 32), bias=False)
    (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (transformer): Transformer(
      (resblocks): ModuleList(
        (0-11): 12 x ResidualAttentionBlock(
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
    (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  )
  (transformer): Transformer(
    (resblocks): ModuleList(
      (0-11): 12 x ResidualAttentionBlock(
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (token_embedding): Embedding(49408, 512)
  (ln_final): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
)
2024-02-27,18:03:19 | INFO | Params:
2024-02-27,18:03:19 | INFO |   batch_size: 256
2024-02-27,18:03:19 | INFO |   beta1: 0.9
2024-02-27,18:03:19 | INFO |   beta2: 0.98
2024-02-27,18:03:19 | INFO |   checkpoint_path: ./logs/negCLIP/negclip_256_1e-6-att-tune/checkpoints
2024-02-27,18:03:19 | INFO |   copy_codebase: False
2024-02-27,18:03:19 | INFO |   csv_caption_key: title
2024-02-27,18:03:19 | INFO |   csv_hard_captions_key: neg_caption
2024-02-27,18:03:19 | INFO |   csv_img_key: filepath
2024-02-27,18:03:19 | INFO |   csv_separator: 	
2024-02-27,18:03:19 | INFO |   dataset_resampled: False
2024-02-27,18:03:19 | INFO |   dataset_type: auto
2024-02-27,18:03:19 | INFO |   ddp_static_graph: False
2024-02-27,18:03:19 | INFO |   debug: False
2024-02-27,18:03:19 | INFO |   device: cuda:0
2024-02-27,18:03:19 | INFO |   dist_backend: nccl
2024-02-27,18:03:19 | INFO |   dist_url: env://
2024-02-27,18:03:19 | INFO |   distributed: False
2024-02-27,18:03:19 | INFO |   epochs: 5
2024-02-27,18:03:19 | INFO |   eps: 1e-06
2024-02-27,18:03:19 | INFO |   force_quick_gelu: False
2024-02-27,18:03:19 | INFO |   gather_with_grad: False
2024-02-27,18:03:19 | INFO |   grad_checkpointing: False
2024-02-27,18:03:19 | INFO |   horovod: False
2024-02-27,18:03:19 | INFO |   imagenet_v2: None
2024-02-27,18:03:19 | INFO |   imagenet_val: None
2024-02-27,18:03:19 | INFO |   local_loss: False
2024-02-27,18:03:19 | INFO |   local_rank: 0
2024-02-27,18:03:19 | INFO |   lock_image: False
2024-02-27,18:03:19 | INFO |   lock_image_freeze_bn_stats: False
2024-02-27,18:03:19 | INFO |   lock_image_unlocked_groups: 0
2024-02-27,18:03:19 | INFO |   log_level: 20
2024-02-27,18:03:19 | INFO |   log_local: False
2024-02-27,18:03:19 | INFO |   log_path: ./logs/negCLIP/negclip_256_1e-6-att-tune/out.log
2024-02-27,18:03:19 | INFO |   logs: ./logs/negCLIP/
2024-02-27,18:03:19 | INFO |   lr: 1e-06
2024-02-27,18:03:19 | INFO |   model: ViT-B-32
2024-02-27,18:03:19 | INFO |   name: negclip_256_1e-6-att-tune
2024-02-27,18:03:19 | INFO |   no_set_device_rank: False
2024-02-27,18:03:19 | INFO |   norm_gradient_clip: None
2024-02-27,18:03:19 | INFO |   precision: amp
2024-02-27,18:03:19 | INFO |   pretrained: openai
2024-02-27,18:03:19 | INFO |   pretrained_image: False
2024-02-27,18:03:19 | INFO |   rank: 0
2024-02-27,18:03:19 | INFO |   report_to: 
2024-02-27,18:03:19 | INFO |   resume: None
2024-02-27,18:03:19 | INFO |   save_frequency: 1
2024-02-27,18:03:19 | INFO |   save_most_recent: False
2024-02-27,18:03:19 | INFO |   seed: 0
2024-02-27,18:03:19 | INFO |   skip_scheduler: False
2024-02-27,18:03:19 | INFO |   tensorboard: False
2024-02-27,18:03:19 | INFO |   tensorboard_path: 
2024-02-27,18:03:19 | INFO |   torchscript: False
2024-02-27,18:03:19 | INFO |   trace: False
2024-02-27,18:03:19 | INFO |   train_data: ./mscoco_with_negatives_training.csv
2024-02-27,18:03:19 | INFO |   train_num_samples: None
2024-02-27,18:03:19 | INFO |   tune_att: False
2024-02-27,18:03:19 | INFO |   use_bn_sync: False
2024-02-27,18:03:19 | INFO |   val_data: ./mscoco_with_negatives_valid.csv
2024-02-27,18:03:19 | INFO |   val_frequency: 1
2024-02-27,18:03:19 | INFO |   val_num_samples: None
2024-02-27,18:03:19 | INFO |   wandb: False
2024-02-27,18:03:19 | INFO |   wandb_notes: 
2024-02-27,18:03:19 | INFO |   warmup: 50
2024-02-27,18:03:19 | INFO |   wd: 0.2
2024-02-27,18:03:19 | INFO |   workers: 14
2024-02-27,18:03:19 | INFO |   world_size: 1
2024-02-27,18:03:19 | INFO |   zeroshot_frequency: 2
